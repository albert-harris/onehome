<?php/** * User: Jason * Date: 5/16/14 * Time: 3:36 PM */class BankRequestController extends Controller {    public function actionIndex(){        $model = new BankRequest();        if(isset($_POST['BankRequest'])){            $model->attributes = $_POST['BankRequest'];            $model->choosetype = isset($_POST['choosetype'])?$_POST['choosetype']:0;            $model->property_type_code = isset($_POST['property_type_code'])?is_array($_POST['property_type_code'])?implode(',', $_POST['property_type_code']):"":'';            if ($model->validate()) {                $model->tenancy_expiry_datepicker = MyFormat::indexDateToDbDate($model->tenancy_expiry_datepicker);                $model->target_price = (float)$model->target_price;                if($model->save()){                    //email to Admin                    SendEmail::sendMailBankRequestToAdmin($model);                    $link_thanks = Yii::app()->createAbsoluteUrl('page/index', array('slug' => Pages::getSlugById(PAGE_THANK_BANK_VALUATION_REQUEST)));                    $this->redirect($link_thanks);                }            }        }    }    public function actionCheckPropertyType() {        $response = array();        if($_POST)        {            $property = ProPropertyType::findParentById($_POST['id']);            if (isset($property)) {                if($property->id == SHOP_HOUSE || $property->id == LAND_SIZE ||                    $property->id ==  BUILT_UP_SIZE || $property->id ==  RETAIL ||                   $property->id ==  LANDED_HOUSE ){                    $response['msg'] = 'ok';                }                else{                    $response['msg'] = 'not_ok';                }            }            else{                $response['msg'] = 'ok';            }        }                echo json_encode($response);        die;    }    }